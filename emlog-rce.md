# Info:

Vulnerability Title:  emlog pro 1.6.0 blog system exists Remote Command Execution Vulnerability

Vulnerability address: 

> https://www.emlog.net/download（Need to download to local installation，Install according to prompts）
>

Affected version: v1.6.0

Discovery time: September 29, 2022

Found by: Xinghe

# Analysis report:

Vulnerability path: http://127.0.0.1/admin/plugin.php , function point: extension ->plug-in ->add plug-in

![image-20220929205051514](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209292050735.png)

See specific development documents :https://www.emlog.net/docs/#/plugin , here we directly use the developed plug-in, and upload it by adding a webshell code

The plug-in download link is as follows: https://github.com/xinghe0/Vulnerability-Report/blob/main/wallpaper.zip , I added an additional webshell code to this plug-in, and the contents are as follows:

![image-20220929205850401](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209292058471.png)

Upload the plug-in zip file containing webshell code, and the following interface will indicate success

![image-20220929215529756](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209292155818.png)

The webshell path is http://127.0.0.1/content/plugins/wallpaper/shell.php

![image-20220929210304617](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209292103668.png)

Use the webshell link tool to connect to the PHP trojan. 

The tool download link is: https://github.com/AntSwordProject/antSword/releases

You have successfully obtained the shell

![image-20220929210906641](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209292109699.png)

Or use the http request tool to verify

![image-20220929211230828](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209292112906.png)

# Repair plan:

Verify the validity of the plug-in, try to install it from the store and verify the md5 value of the file