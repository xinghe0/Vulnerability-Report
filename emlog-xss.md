# Info：

Vulnerability Title:  emlog pro 1.6.0 blog system exists stored XSS

Vulnerability address: 

> https://www.emlog.net/download（Need to download to local installation）
>
> https://demo.emlog.net/（Online environment，user：emlog，pass：123456）

Affected version: v1.6.0

Discovery time: September 29, 2022

Found by: Xinghe

# Analysis report:

Vulnerability Path： https://demo.emlog.net/admin/article.php?action=write，Function point: Article ->Write Article. The contents are as follows

```
part1
<script>alert(1)</script>

part2
<script>alert(2)<script>
```

![image-20220929185943939](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209291859989.png)

Next Text Box

![image-20220929190103250](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209291901292.png)

Save and Return

![image-20220929190131805](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209291901867.png)

Save, return and return to the article page. This is the first vulnerability trigger point. Articles written by ordinary users will be reviewed by the administrator. In this step, some cookies of the administrator can be obtained through xss, and xss payload will be written into the MySQL database. When the user browses the article, the payload will be triggered.

![image-20220929191138080](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209291911107.png)

![image-20220929190156213](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209291901272.png)

![image-20220929190236480](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209291902529.png)

![image-20220929190328803](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209291903853.png)

Back to home page https://demo.emlog.net/ , is the second vulnerability trigger point, and clicking it will trigger the first xss, which is stored XSS

![image-20220929190418864](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209291904916.png)

![image-20220929190509769](https://xingheimg.oss-cn-guangzhou.aliyuncs.com/img/202209291905831.png)



# Repair plan:

Escape xss special characters